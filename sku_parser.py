import re
import csv

# --- Mapping helpers ---
cpu_map = {
    "I3": "Intel Core i3",
    "I5": "Intel Core i5",
    "I7": "Intel Core i7",
    "I9": "Intel Core i9",
    "R5": "AMD Ryzen 5",
    "R7": "AMD Ryzen 7",
    "R9": "AMD Ryzen 9"
}

gpu_patterns = ["GTX1050Ti", "GTX1630", "GTX1650", "GTX1660S",
                "RTX3050", "RTX3060", "RTX3070", "RTX3080", "RTX4060", "RTX5060",
                "RX550", "RX580"]

def parse_sku(sku):
    # CPU
    cpu = next((name for code, name in cpu_map.items() if code in sku), "Unknown CPU")
    
    # GPU
    gpu = next((gpu for gpu in gpu_patterns if gpu in sku), "Unknown GPU")

    # RAM
    ram_match = re.search(r"(\d{2})G", sku)
    ram = f"{ram_match.group(1)}GB" if ram_match else "16GB"

    # Storage
    if "2SN" in sku:
        storage = "2TB NVMe SSD"
    elif "1SN" in sku:
        storage = "1TB NVMe SSD"
    elif "2S" in sku or "2000" in sku:
        storage = "2TB SSD"
    elif "1S" in sku or "1000" in sku:
        storage = "1TB SSD"
    elif "512" in sku:
        storage = "512GB SSD"
    else:
        storage = "512GB SSD"

    # Price
    price_map = {
        "GTX1050Ti": 60000,
        "GTX1630": 65000,
        "GTX1650": 70000,
        "GTX1660S": 80000,
        "RX550": 55000,
        "RX580": 75000,
        "RTX3050": 85000,
        "RTX3060": 120000,
        "RTX3070": 140000,
        "RTX3080": 160000,
        "RTX4060": 180000,
        "RTX5060": 200000
    }
    price = price_map.get(gpu, 70000)

    # Name based on SKU prefix
    sku_upper = sku.upper()
    if sku_upper.startswith("AQ"):
        name_prefix = "Aqvin Gaming PC"
    elif sku_upper.startswith("AL"):
        name_prefix = "Hajaan Gaming PC"
    elif sku_upper.startswith("AV"):
        name_prefix = "Hajaan Gaming PC"
    else:
        name_prefix = "Gaming PC"
    name = f"{name_prefix} - {gpu}"

    # Performance category
    if gpu in ["RX550", "RX580"]:
        performance = "Low Spec PC"
    elif gpu in ["GTX1050Ti", "GTX1630", "GTX1650", "GTX1660S"]:
        performance = "Moderate low profile gaming PC"
    elif gpu in ["RTX3050", "RTX3060", "RTX3070"]:
        performance = "High-end gaming PC"
    elif gpu in ["RTX3080", "RTX4060", "RTX5060"]:
        performance = "Super gaming PC for high profile games"
    else:
        performance = "Standard gaming PC"

    # Description
    description = f"{cpu}, {gpu}, {ram}, {storage} — {performance}."

    return {
        "sku": sku,
        "name": name,
        "cpu": cpu,
        "gpu": gpu,
        "ram": ram,
        "storage": storage,
        "price": price,
        "description": description
    }

# --- Input list of SKUs ---
skus = [
    "AQ10T10PI7632G1SGTX1050Ti_24", "AQ10T10PI7632G1SGTX1050Ti_27", "AQ10T10PI7632G1SGTX1630", "AQ10T10PI7632G1SGTX1630_24", "AQ10T10PI7632G1SGTX1630_27", "AQ10T10PI7632G1SGTX1650", "AQ10T10PI7632G1SGTX1650_24", "AQ10T10PI7632G1SGTX1650_27", "AQ10T10PI7632G1SGTX1660", "AQ10T10PI7632G1SGTX1660_24", "AQ10T10PI7632G1SGTX1660_27", "AQ10T10PI7632G1SRX580", "AQ10T10PI7632G1SRX580_24", "AQ10T10PI7632G1SRX580_27", "AQ10T10PI7632G2SGTX1050Ti", "AQ10T10PI7632G2SGTX1050Ti_24", "AQ10T10PI7632G2SGTX1050Ti_27", "AQ10T10PI7632G2SGTX1630", "AQ10T10PI7632G2SGTX1630_24", "AQ10T10PI7632G2SGTX1630_27", "AQ10T10PI7632G2SGTX1650", "AQ10T10PI7632G2SGTX1650_24", "AQ10T10PI7632G2SGTX1650_27", "AQ10T10PI7632G2SGTX1660", "AQ10T10PI7632G2SGTX1660_24", "AQ10T10PI7632G2SGTX1660_27", "AQ10T10PI7632G2SRX580", "AQ10T10PI7632G2SRX580_24", "AQ10T10PI7632G2SRX580_27", "AQ2011PI7870032G1SRTX3070", "AQ2011PI7870032G1SRTX3070_27M", "AQ2011PI7870032G1SRTX3080", "AQ2011PI7870032G1SRTX3080_27M", "AQ2011PI7870032G2SRTX3070", "AQ2011PI7870032G2SRTX3070_27M", "AQ2011PI7870032G2SRTX3080", "AQ2011PI7870032G2SRTX3080_27M", "AQ20I3810032G1SRTX3060", "AQ20I3810032G1SRTX4060", "AQ20I7632G1SGTX1650", "AQ20I7632G1SGTX1660S", "AQ20I7632G1SRTX3050", "AQ20I7632G1SRTX3050_24", "AQ20I7632G1SRTX3060", "AQ20I7632G1SRX580", "AQ20I7632G1SRX580 -E", "AQ20I7632G2SGTX1650", "AQ20I7632G2SGTX1660S", "AQ20I7632G2SRTX3050", "AQ20I7632G2SRTX3060", "AQ20I7632G2SRTX3060_24", "AQ20I7632G2SRX580", "AQ20I7632G2SRX580 -E", "AQ20I7832G1SGTX1650", "AQ20I7832G1SGTX1660S", "AQ20I7832G1SRTX3050", "AQ20I7832G1SRTX3060", "AQ20I7832G1SRTX4060", "AQ20I7832G1SRX580", "AQ20I7832G2SGTX1650", "AQ20I7832G2SGTX1660S", "AQ20I7832G2SRTX3050", "AQ20I7832G2SRTX3060", "AQ20I7832G2SRTX4060", "AQ20I7832G2SRX580", "AQ20I7832G2SRX580 -E", "AQ20I7832G2SRX58024GM -E", "AQ20I7870032G1NVMeRTX50608G", "AQ3010PI7632G1S1660S_27GM", "AQ3010PI7632G1SGTX1050TI", "AQ3010PI7632G1SGTX1650", "AQ3010PI7632G1SGTX1660S", "AQ3010PI7632G1SRTX3050", "AQ3010PI7632G1SRTX30506GB_27GM", "AQ3010PI7632G1SRTX30508GB_27GM", "AQ3010PI7632G1SRTX3060", "AQ3010PI7632G1SRTX306012GB_27GM", "AQ3010PI7632G1SRTX4060", "AQ3010PI7632G1SRTX40608GB_27GM", "AQ3010PI7632G1SRX550", "AQ3010PI7632G1SRX580", "AQ3010PI7632G1SRX580_27GM", "AQ3010PI7632G2S1660S_27GM", "AQ3010PI7632G2SGTX1050TI", "AQ3010PI7632G2SGTX1650", "AQ3010PI7632G2SGTX1660S", "AQ3010PI7632G2SRTX3050", "AQ3010PI7632G2SRTX30506GB_27GM", "AQ3010PI7632G2SRTX30508GB_27GM", "AQ3010PI7632G2SRTX3060", "AQ3010PI7632G2SRTX306012GB_27GM", "AQ3010PI7632G2SRTX4060", "AQ3010PI7632G2SRTX40608GB_27GM", "AQ3010PI7632G2SRX550", "AQ3010PI7632G2SRX580", "AQ3010PI7632G2SRX580_27GM", "AQ50I7632G1SGTX1660S", "AQ50I7632G1SGTX1660S_27GM", "AQ50I7632G1SRTX3050", "AQ50I7632G1SRTX30506GB", "AQ50I7632G1SRTX30506GB_27GM", "AQ50I7632G1SRTX30508GB_27GM", "AQ50I7632G1SRTX3060", "AQ50I7632G1SRTX306012GB_27GM", "AQ50I7632G1SRX580", "AQ50I7632G1SRX580_27GM", "AQ50I7632G2SGTX1660S", "AQ50I7632G2SGTX1660S_27GM", "AQ50I7632G2SRTX3050", "AQ50I7632G2SRTX30506GB", "AQ50I7632G2SRTX30506GB_27GM", "AQ50I7632G2SRTX30508GB_27GM", "AQ50I7632G2SRTX3060", "AQ50I7632G2SRTX3060_27GM", "AQ50I7632G2SRTX3060_27GM -E", "AQ50I7632G2SRTX306012GB_27GM", "AQ50I7632G2SRX580", "AQ50I7632G2SRX580_27GM", "AQ50I7832G1SRX580 -E", "AQ80I7832G1NVMeGTX1050Ti11P", "AQ80I7832G1NVMeGTX165011P", "AQ80I7832G1NVMeGTX166011P", "AQ80I7832G1NVMeRTX30506GB11P", "AQ80I7832G1NVMeRTX30508GB11P", "AQ80I7832G1NVMeRTX306012GB11P", "AQ80I7832G1NVMeRTX40608GB11P", "AQ80I7832G2NVMeGTX1050Ti11P", "AQ80I7832G2NVMeGTX165011P", "AQ80I7832G2NVMeGTX166011P", "AQ80I7832G2NVMeRTX30506GB11P", "AQ80I7832G2NVMeRTX30508GB11P", "AQ80I7832G2NVMeRTX306012GB11P", "AQ80I7832G2NVMeRTX40608GB11P", "AQ80I7870032G1NVMeRTX50608G", "AQB60I7632G1SGTX1660S", "AQB60I7632G1SRTX3050", "AQB60I7632G1SRTX30506GB", "AQB60I7632G1SRTX3060", "AQB60I7632G1SRX580", "AQB60I7632G1SRX580_27GB", "AQB60I7632G2SGTX1660S", "AQB60I7632G2SRTX3050", "AQB60I7632G2SRTX30506GB", "AQB60I7632G2SRTX3060", "AQB60I7632G2SRX580", "AQB70I7632G1SGTX1660S", "AQB70I7632G1SGTX1660S_27", "AQB70I7632G1SGTX1660S_27GM", "AQB70I7632G1SRTX3050", "AQB70I7632G1SRTX3050_27", "AQB70I7632G1SRTX30506GB", "AQB70I7632G1SRTX30506GB_27GM", "AQB70I7632G1SRTX30508GB_27GM", "AQB70I7632G1SRTX3060", "AQB70I7632G1SRTX3060_27", "AQB70I7632G1SRTX306012GB_27GM", "AQB70I7632G1SRX580", "AQB70I7632G1SRX580_27", "AQB70I7632G1SRX580_27GM", "AQB70I7632G2SGTX1660S", "AQB70I7632G2SGTX1660S_27", "AQB70I7632G2SGTX1660S_27GM", "AQB70I7632G2SRTX3050", "AQB70I7632G2SRTX3050_27", "AQB70I7632G2SRTX30506GB", "AQB70I7632G2SRTX30506GB_27GM", "AQB70I7632G2SRTX30508GB_27GM", "AQB70I7632G2SRTX3060", "AQB70I7632G2SRTX3060_27", "AQB70I7632G2SRTX306012GB_27GM", "AQB70I7632G2SRX580", "AQB70I7632G2SRX580_27", "AQB70I7632G2SRX580_27GM", "AQB70I7870032G1NVMeRTX50608G", "AQILTI5832G1SGTX1050Ti", "AQILTI5832G1SGTX1630", "AQILTI5832G1SGTX1650", "AQILTI5832G1SRTX3050", "AQILTI5832G1SRX550", "AQILTI7632G1SGTX1050Ti", "AQILTI7632G1SGTX1050Ti24NM", "AQILTI7632G1SGTX1050Ti27NM", "AQILTI7632G1SGTX1630", "AQILTI7632G1SGTX1650", "AQILTI7632G1SGTX165024NM", "AQILTI7632G1SGTX165027NM", "AQILTI7632G1SRX550", "AQILTI7632G1SRX55024NM", "AQILTI7632G1SRX55027NM", "AQILTI7632G512SRX55024NM", "AQILTI7632G512SRX55027NM", "AQILTI7732G1SGTX1050Ti", "AQILTI7732G1SGTX1630", "AQILTI7732G1SGTX1650", "AQILTI7832G1SGTX1050Ti", "AQILTI7832G1SGTX1630", "AQILTI7832G1SGTX1650", "AQILTI7832G1SRTX3050", "AQLRTI5832G1SGTX1050Ti", "AQLRTI5832G1SGTX1050Ti_27GM", "AQLRTI5832G1SGTX1630", "AQLRTI5832G1SGTX1630_27GM", "AQLRTI5832G1SGTX1650", "AQLRTI5832G1SGTX1650_27GM", "AQLRTI5832G1SRTX3050", "AQLRTI5832G1SRTX3050_27GM", "AQLRTI5832G1SRX550", "AQLRTI5832G1SRX550_27GM", "AQLRTI7632G1SGTX1050Ti", "AQLRTI7632G1SGTX1050Ti_27GM", "AQLRTI7632G1SGTX1050Ti24NM", "AQLRTI7632G1SGTX1050Ti27NM", "AQLRTI7632G1SGTX1630", "AQLRTI7632G1SGTX1630_27GM", "AQLRTI7632G1SGTX1650", "AQLRTI7632G1SGTX1650_27GM", "AQLRTI7632G1SGTX165024NM", "AQLRTI7632G1SGTX165027NM", "AQLRTI7632G1SRX550", "AQLRTI7632G1SRX550 _27GM", "AQLRTI7632G1SRX55024NM", "AQLRTI7632G1SRX55027NM", "AQLRTI7632G512SRX55024NM", "AQLRTI7632G512SRX55027NM", "AQLRTI7732G1SGTX1050Ti", "AQLRTI7732G1SGTX1050Ti_27GM", "AQLRTI7732G1SGTX1630", "AQLRTI7732G1SGTX1630_27GM", "AQLRTI7732G1SGTX1650", "AQLRTI7732G1SGTX1650_27GM", "AQLRTI7832G1SGTX1050Ti", "AQLRTI7832G1SGTX1050Ti_27GM", "AQLRTI7832G1SGTX1630", "AQLRTI7832G1SGTX1630_27GM", "AQLRTI7832G1SGTX1650", "AQLRTI7832G1SGTX1650_27GM", "AQLRTI7832G1SRTX3050", "AQLRTI7832G1SRTX3050_27GM", "AQNEI7870032G1NV11P", "AQNEI7870032G2NV11P", "AQW60I7632G1SGTX1650", "AQW60I7632G1SGTX1660S", "AQW60I7632G1SRTX3050", "AQW60I7632G1SRTX3060", "AQW60I7632G1SRX580", "AQW60I7632G1SRX580_27GM", "AQW60I7632G2SGTX1650", "AQW60I7632G2SGTX1660S", "AQW60I7632G2SRTX3050", "AQW60I7632G2SRTX3060", "AQW60I7632G2SRX580", "AQW70I7632G1SGTX1660S", "AQW70I7632G1SRTX3050", "AQW70I7632G1SRTX3060", "AQW70I7632G1SRX580", "AQW70I7632G2SGTX1660S", "AQW70I7632G2SRTX3050", "AQW70I7632G2SRTX3060", "AQW70I7632G2SRX580", "AV10PI7632G1SGTX1660S_27GM -E", "AV10PI7632G1SRTX30506GB_27GM -E", "AV10PI7632G1SRTX30508GB_27GM -E", "AV10PI7632G1SRTX306012GB_27GM -E", "AV10PI7632G1SRX580_27GM -E", "AV10PI7632G2SGTX1660S_27GM -E", "AV10PI7632G2SRTX30506GB_27GM -E", "AV10PI7632G2SRTX30508GB_27GM -E", "AV10PI7632G2SRTX306012GB_27GM -E", "AV10PI7632G2SRX580_27GM -E", "AV10PI7670032G1SGTX1050Ti", "AV10PI7670032G1SGTX1050Ti-24NM", "AV10PI7670032G1SGTX1050Ti-27NM", "AV10PI7670032G1SGTX1650", "AV10PI7670032G1SGTX1650-24NM", "AV10PI7670032G1SGTX1650-27NM", "AV10PI7670032G1SRTX30506GB", "AV10PI7670032G1SRTX30508GB", "AV10PI7670032G1SRTX3060_27GM", "AV10PI7670032G1SRTX306012G", "AV10PI7670032G1SRTX306012G_24''", "AV10PI7670032G1SRX550", "AV10PI7670032G1SRX550_24''", "AV10PI7670032G1SRX550-24NM", "AV10PI7670032G1SRX550-27NM", "AV10PI7670032G2SRTX30506GB", "AV10PI7670032G2SRTX30508GB", "AV10PI7670032G2SRTX3060_27GM", "AV10PI7670032G2SRTX306012G", "AV10PI7670032G2SRTX306012G_24''", "AV10PI7670032G512SGTX1050Ti", "AV10PI7670032G512SGTX1050Ti-24NM", "AV10PI7670032G512SGTX1050Ti-27NM", "AV10PI7670032G512SGTX1630", "AV10PI7670032G512SGTX1650", "AV10PI7670032G512SGTX1650_24''", "AV10PI7670032G512SGTX1650-24NM", "AV10PI7670032G512SGTX1650-27NM", "AV10PI7670032G512SRTX30506GB", "AV10PI7670032G512SRTX30508GB", "AV10PI7670032G512SRTX3060_27GM", "AV10PI7670032G512SRX550", "AV10PI7670032G512SRX550_24''", "AV10PI7670032G512SRX550-24NM", "AV10PI7670032G512SRX550-27NM", "AV10PI7832G1SRTX40608GB_27GM -E", "AV10PI7832G2SRTX40608GB_27GM -E", "AV11PAMDR716G1SRTX3050", "AV11PAMDR716G1SRTX3050_27GM", "AV11PAMDR716G512SRTX3050", "AV11PAMDR716G512SRTX3050_27GM", "AV11PAMDR732G1SRTX3050", "AV11PAMDR732G1SRTX3050_GM", "AV11PAMDR732G512SRTX3050", "AV11PAMDR732G512SRTX3050_GM", "AV11PI5850032G1SGTX1050Ti", "AV11PI5850032G1SGTX1630", "AV11PI5850032G1SGTX1650", "AV11PI5850032G1SRX550", "AV11PI5850032G2SGTX1050Ti", "AV11PI5850032G2SGTX1630", "AV11PI5850032G2SGTX1650", "AV11PI5850032G2SRX550", "AV11PI5850032G512SGTX1050Ti", "AV11PI5850032G512SGTX1630", "AV11PI5850032G512SGTX1650", "AV11PI5850032G512SRX550", "AV11PI7870032G1NVMeRTX50608G", "AV11PI7870032G1SGTX1050Ti", "AV11PI7870032G1SGTX1630", "AV11PI7870032G1SGTX1650", "AV11PI7870032G1SGTX1660", "AV11PI7870032G1SRTX30506GB", "AV11PI7870032G1SRTX30508GB", "AV11PI7870032G1SRTX3060 - E", "AV11PI7870032G1SRTX306012GB", "AV11PI7870032G1SRTX3070", "AV11PI7870032G1SRTX3070_27M", "AV11PI7870032G1SRTX3080", "AV11PI7870032G1SRTX3080_27M", "AV11PI7870032G1SRTX40608GB", "AV11PI7870032G1SRX550", "AV11PI7870032G1SRX580", "AV11PI7870032G2SGTX1050Ti", "AV11PI7870032G2SGTX1630", "AV11PI7870032G2SGTX1650", "AV11PI7870032G2SGTX1660", "AV11PI7870032G2SRTX30506GB", "AV11PI7870032G2SRTX30508GB", "AV11PI7870032G2SRTX3060", "AV11PI7870032G2SRTX306012GB", "AV11PI7870032G2SRTX3070", "AV11PI7870032G2SRTX3070_27M", "AV11PI7870032G2SRTX3080", "AV11PI7870032G2SRTX3080_27M", "AV11PI7870032G2SRTX40608GB", "AV11PI7870032G2SRX550", "AV11PI7870032G2SRX580", "AV11PI7870032G512SGTX1050Ti", "AV11PI7870032G512SGTX1630", "AV11PI7870032G512SGTX1650", "AV11PI7870032G512SRX550", "AVI310100F16G1SGTX1050TI", "AVI310100F16G1SGTX1650", "AVI3810032G1SRTX3060", "AVI3810032G1SRTX3060_24", "AVI3810032G1SRTX4060", "AVI3810032G1SRTX4060_24"   
]
# --- Save to CSV ---
with open("pc_parts.csv", "w", newline="", encoding="utf-8") as csvfile:
    fieldnames = ["sku", "name", "cpu", "gpu", "ram", "storage", "price", "description"]
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
    writer.writeheader()

    for sku in skus:
        writer.writerow(parse_sku(sku))

print("✅ pc_parts.csv generated successfully")


